$(function(){var o=$("#rowCount").find(":selected").text(),i='<i class="fa fa-spinner fa-pulse fa-lg fa-fw d-block mx-auto text-white"></i><span class="sr-only">Loading...</span>',e=$("#option1, #option2, #option3"),s=new hullabaloo,l=function(e,t){$.ajax({url:baseurl+"admin/report/draft/handler/populate-draft/"+e+"/",type:"GET",dataType:"html",data:{page:e,rows:t},beforeSend:function(){$("#draftTable").html(i)},success:function(e){$("#draftTable").html(""),$("#draftTable").html(e)},fail:function(e,t,a){console.log(a)}})},t=function(e){$.ajax({url:baseurl+"admin/report/handler/id",type:"GET",dataType:"html",data:{repotype:e},success:function(e){$("#repid").val(e)},fail:function(){console.log("Error")}})},a=function(){return $("#tableDraft input:checked").map(function(){return this.value}).get().join("-")};$("#customer").autocomplete({source:function(e,a){$.ajax({url:baseurl+"admin/customers/customer/append-customer",dataType:"json",data:{q:e.term}}).success(function(e){var t=$.map(e,function(e,t){return{label:e.firstname+" "+e.lastname,value:e.firstname+" "+e.lastname,id:e.custid}});a(t)})},minLength:1,select:function(e,t){$("#customerID").val(t.item.id)}}),$("#shapecutField").autocomplete({source:function(e,a){$.ajax({url:baseurl+"admin/report/handler/populate-shapecut",dataType:"json",data:{q:e.term}}).success(function(e){var t=$.map(e,function(e,t){return{label:e.shapecut,value:e.shapecut}});a(t)})},minLength:2}),$("#colorField").autocomplete({source:function(e,a){$.ajax({url:baseurl+"admin/report/handler/populate-color",dataType:"json",data:{q:e.term}}).success(function(e){var t=$.map(e,function(e,t){return{label:e.color,value:e.color}});a(t)})},minLength:2}),e.click(function(){"option1"==this.id?($("#repotype").val($(this).data("value")),t($(this).data("value"))):"option2"==this.id?($("#repotype").val($(this).data("value")),t($(this).data("value"))):"option3"==this.id&&($("#repotype").val($(this).data("value")),t($(this).data("value")))}),l(1,o),$("#pStatus").change(function(){"paid-advance"==$(this).val()?$("#adField").show():$("#adField").hide()}),$("#rowCount").on("change",function(){l(1,this.value)}),$("#searchId").keyup(function(){var e,t=$(this).val();2<=t.length&&(e=t,$.ajax({url:baseurl+"admin/report/draft/handler/populate-draft",type:"GET",dataType:"html",data:{search:!0,id:e},beforeSend:function(){$("#draftTable").html(i)},success:function(e){$("#draftTable").html(""),$("#draftTable").html(e)},fail:function(e,t,a){console.log(a)}}))}),$("#paymentModal").on("hidden.bs.modal",function(e){$("#paymentForm").trigger("reset"),$("#adField").hide()});var n={pagination:function(e){e.preventDefault();var t=$(this).data("ci-pagination-page");l(t,o)},reload:function(e){e.preventDefault(),$("#rowCount").prop("selectedIndex",0),$("#searchId").val(""),l(1,o)},saveDraft:function(e){var t,a,n,r;e.preventDefault(),t=$("#addReportDraft"),a=new FormData,n=$("#customerID").val(),r=t.serializeArray(),$.each(r,function(e,t){a.append(t.name,t.value)}),a.append("customer",n),$.ajax({url:t.attr("action"),type:t.attr("method"),dataType:"JSON",data:a,processData:!1,contentType:!1,beforeSend:function(){$(".btn-save").html(i)},success:function(e){if($(".btn-save").html("Save"),e.auth)return s.send(e.message,"success"),l(1,o),$("#downlaodQrBtn").html('<a href="'+e.url+'" class="btn btn-sm btn-danger mt-3"><i class="fa fa-download fa-fw"></i> Download</a>'),a=null,t.trigger("reset"),!0;s.send(e.message,"danger")},error:function(e,t,a){s.send(a,"danger")}})},payment:function(){$("#pRepId").val($(this).data("id")),$("#pRepType").val($(this).data("type"))},saveAmount:function(e){var t,a,n;e.preventDefault(),t=$("#paymentForm"),a=new FormData,n=t.serializeArray(),$.each(n,function(e,t){a.append(t.name,t.value)}),$.ajax({url:t.attr("action"),type:t.attr("method"),dataType:"JSON",data:a,processData:!1,contentType:!1,beforeSend:function(){$("#payBtnSave").html(i)},success:function(e){if($("#payBtnSave").html("Save"),e.auth)return s.send(e.message,"success"),l(1,o),$("#receiptCount").text(e.total),$("#paymentModal").modal("hide"),a=null,t.trigger("reset"),!0;s.send(e.message,"danger")},error:function(e,t,a){s.send(a,"danger")}})},delete:function(){$("#dRepId").val($(this).data("id")),$("#dRepType").val($(this).data("type")),$("#spRepId").text($(this).data("repid"))},deleteReport:function(e){e.preventDefault(),$.ajax({url:baseurl+"admin/report/draft/handler/delete/rep",type:"GET",dataType:"json",data:{id:$("#dRepId").val(),type:$("#dRepType").val()},success:function(e){if(e.auth)return s.send(e.message,"success"),$("#deleteModal").modal("hide"),!0;s.send(e.message,"danger")},error:function(e,t,a){s.send(a,"danger")}}),l(1,o)}};$(document).on("click","a[data-action]",function(e){var t=$(this).data("action");"function"==typeof n[t]&&n[t].call(this,e)}),$(document).on("click","td:first-child input",function(){var e=baseurl+"admin/report/print/receipt/"+a();$(this).closest("tr").toggleClass("highlight",this.checked),$("#btnPrint").attr("href",e)}),$(document).on("change","th:first-child input",function(){$(this).closest("table").find(":checkbox").prop("checked",$(this).is(":checked"));var e=baseurl+"admin/report/print/receipt/"+a();$(this).closest("table").find("tr").toggleClass("highlight",this.checked),$("#btnPrint").attr("href",e)})});
//# sourceMappingURL=maps/report.draft.js.map
