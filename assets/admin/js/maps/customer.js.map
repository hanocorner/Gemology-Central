{"version":3,"sources":["customer.js"],"names":["$","formData","formAdd","formEdit","hulla","hullabaloo","spinner","rows","find","text","populate","pg","rw","htmlData","ajax","url","baseurl","type","dataType","data","page","beforeSend","html","success","fail","jqXHR","textStatus","errorThrown","console","log","window","location","pathname","split","on","this","value","event","preventDefault","btnActions","add","modal","adCustomer","FormData","ajaxLoader","x","serializeArray","each","i","field","append","name","attr","processData","contentType","hide","response","show","auth","send","message","trigger","addCustomer","deleteModal","val","deleteCustomer","id","token","cid","csrf_test_name","editCustomer","eLoader","updateCustomer","editModal","isEmptyObject","firstname","lastname","number","email","custid","reloadCustomer","pagination","document","action","call"],"mappings":"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","file":"../customer.js","sourcesContent":["$(function () {\r\n\r\n\t/* Varibales */\r\n\r\n\tvar formData = null;\r\n\tvar formAdd = $('#formAddCustomer');\r\n\tvar formEdit = $('#formEditCustomer');\r\n\tvar hulla = new hullabaloo();\r\n\tvar spinner = '<i class=\"fa fa-spinner fa-spin fa-lg fa-fw d-block mx-auto text-primary mt-3\"></i><span class=\"sr-only\">Loading...</span>';\r\n\tvar rows = $('#rowCount').find(\":selected\").text();\r\n\r\n\t/* Functions */\r\n\r\n\t// Executing functions according to url\r\n\tvar urlBasedAction = function () {\r\n\t\treturn window.location.pathname.split('/');\r\n\t};\r\n\r\n\t// Populating the customers grid \r\n\tvar populate = function (pg, rw) {\r\n\t\tvar htmlData = $('#allCustomerData');\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/populate',\r\n\t\t\ttype: 'GET',\r\n\t\t\tdataType: 'html',\r\n\t\t\tdata: {\r\n\t\t\t\tpage: pg,\r\n\t\t\t\trows: rw\r\n\t\t\t},\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\thtmlData.html(spinner);\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\thtmlData.html('');\r\n\t\t\t\thtmlData.html(data);\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// Add a new customer\r\n\tvar addCustomer = function () {\r\n\t\tformData = new FormData();\r\n\t\tvar ajaxLoader = $('#ajaxLoader');\r\n\t\tvar x = formAdd.serializeArray();\r\n        $.each(x, function(i, field){\r\n            formData.append(field.name, field.value);\r\n\t\t});\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: formAdd.attr(\"action\"),\r\n\t\t\ttype: formAdd.attr(\"method\"),\r\n            dataType: 'JSON',\r\n            data: formData,\r\n\t\t\tprocessData: false,\r\n\t\t\tcontentType: false,\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\tformAdd.hide();\r\n\t\t\t\tajaxLoader.html(spinner);\t\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\tajaxLoader.html('');\t\r\n\t\t\t\tformAdd.show();\r\n\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#addModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\t\t\t\t\tformData = null;\r\n\t\t\t\t\tformAdd.trigger(\"reset\");\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n\r\n\t// Populate Edit form\r\n\tvar populateEdit = function (id, token) {\r\n\t\tvar eLoader = $('#eLoader');\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/populate-edit',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: {\r\n\t\t\t\tcid: id,\r\n\t\t\t\tcsrf_test_name: token\r\n\t\t\t},\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\teLoader.html(spinner);\r\n\t\t\t\tformEdit.hide();\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\teLoader.html('');\r\n\t\t\t\tformEdit.show();\r\n\t\t\t\tif($.isEmptyObject(data) || data == null)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#editModal').modal('hide');\r\n\t\t\t\t\thulla.send('Unable to fetch data', 'danger');\r\n\t\t\t\t\tconsole.log('empty');\r\n\t\t\t\t\treturn false;\t\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t$('#eFname').val(data.firstname);\r\n\t\t\t\t\t$('#eLname').val(data.lastname);\r\n\t\t\t\t\t$('#eNumber').val(data.number);\r\n\t\t\t\t\t$('#eEmail').val(data.email);\r\n\t\t\t\t\t$('#customerEditId').val(data.custid);\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t// Update Customer based on user input\r\n\tvar updateCustomer = function () {\r\n\t\tformData = new FormData();\r\n\t\tvar eLoader = $('#eLoader');\r\n\r\n\t\tvar x = formEdit.serializeArray();\r\n        $.each(x, function(i, field){\r\n            formData.append(field.name, field.value);\r\n\t\t});\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: formEdit.attr(\"action\"),\r\n\t\t\ttype: formEdit.attr(\"method\"),\r\n            dataType: 'JSON',\r\n            data: formData,\r\n\t\t\tprocessData: false,\r\n\t\t\tcontentType: false,\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\teLoader.html(spinner);\r\n\t\t\t\tformEdit.hide();\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\teLoader.html('');\r\n\t\t\t\tformEdit.show();\r\n\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#editModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\t\t\t\t\tformData = null;\r\n\t\t\t\t\tformEdit.trigger(\"reset\");\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\t\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// Delete customer\r\n\tvar delCustomer = function (id, token) {\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/delete',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: {\r\n\t\t\t\tcid: id,\r\n\t\t\t\tcsrf_test_name: token\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#delModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\t\r\n\r\n\t\t\t\tid = null;\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t/* Binding */\r\n\r\n\t// Uri Action\r\n\tvar uri = urlBasedAction();\r\n\t\r\n\t// Trigerring the populate customer function\r\n\tif (uri[2] == 'customer') {\r\n\t\tpopulate(1, rows);\r\n\r\n\t\t$('#rowCount').on('change', function () {\r\n\t\t\tpopulate(1, this.value);\r\n\t\t});\r\n\r\n\t\t$('a[data-action=reload]').on('click', function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tpopulate(1, 10);\r\n\t\t});\r\n\r\n\t\t// Anchor button actions binding\r\n\t\tvar btnActions = {\r\n\t\t\tadd: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#addModal').modal('toggle');\r\n\t\t\t},\r\n\t\t\tadCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\taddCustomer();\r\n\t\t\t},\r\n\t\t\tdeleteModal: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#delModal').modal('toggle');\r\n\t\t\t\t$('#cstid').val($(this).data('id'));\r\n\t\t\t},\r\n\t\t\tdeleteCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tdelCustomer($('#cstid').val(), $(this).data('csrf'));\r\n\t\t\t},\r\n\t\t\teditCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tupdateCustomer($(this).data('id'));\r\n\t\t\t},\r\n\t\t\teditModal: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#editModal').modal('toggle');\r\n\t\t\t\tpopulateEdit($(this).data('id'), $(this).data('csrf'));\r\n\t\t\t},\r\n\t\t\treloadCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tpopulate(1, rows);\r\n\t\t\t},\r\n\t\t\tpagination: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tvar page = $(this).data(\"ci-pagination-page\");\r\n\t\t\t\tpopulate(page, rows);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$(document).on(\"click\", 'a[data-action]', function (event) {\r\n\t\t\tvar link = $(this);\r\n\t\t\tvar action = link.data(\"action\");\r\n\r\n\t\t\tif (typeof btnActions[action] === \"function\") {\r\n\t\t\t\tbtnActions[action].call(this, event);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}); // End of document ready"]}