{"version":3,"sources":["customer.js"],"names":["$","formData","formAdd","formEdit","hulla","hullabaloo","spinner","rows","find","text","htmlData","populate","pg","rw","ajax","url","baseurl","type","dataType","data","page","beforeSend","html","success","fail","jqXHR","textStatus","errorThrown","console","log","window","location","pathname","split","on","this","value","keyup","key","val","length","search","query","btnActions","add","event","preventDefault","modal","adCustomer","FormData","ajaxLoader","x","serializeArray","each","i","field","append","name","attr","processData","contentType","hide","response","show","auth","send","message","trigger","addCustomer","deleteModal","deleteCustomer","id","token","cid","csrf_test_name","editCustomer","eLoader","updateCustomer","editModal","isEmptyObject","firstname","lastname","number","email","custid","reloadCustomer","prop","pagination","document","action","call"],"mappings":"AAAAA,EAAE,WAID,IAAIC,EAAW,KACXC,EAAUF,EAAE,oBACZG,EAAWH,EAAE,qBACbI,EAAQ,IAAIC,WACZC,EAAU,6HACVC,EAAOP,EAAE,aAAaQ,KAAK,aAAaC,OACxCC,EAAWV,EAAE,oBAUbW,EAAW,SAAUC,EAAIC,GAE5Bb,EAAEc,KAAK,CACNC,IAAKC,QAAU,oCACfC,KAAM,MACNC,SAAU,OACVC,KAAM,CACLC,KAAMR,EACNL,KAAMM,GAEPQ,WAAY,WACXX,EAASY,KAAKhB,IAEfiB,QAAS,SAAUJ,GAClBT,EAASY,KAAK,IACdZ,EAASY,KAAKH,IAEfK,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,OAyLf,GAAc,YA/MNG,OAAOC,SAASC,SAASC,MAAM,KA+M/B,GAAkB,CACzBtB,EAAS,EAAGJ,GAEZP,EAAE,aAAakC,GAAG,SAAU,WAC3BvB,EAAS,EAAGwB,KAAKC,SAIlBpC,EAAE,cAAcqC,MAAM,WACrB,IArC6BC,EAqCzBA,EAAMtC,EAAEmC,MAAMI,MACA,GAAdD,EAAIE,QAtCqBF,EAuCbA,EAtCjBtC,EAAEc,KAAK,CACNC,IAAKC,QAAU,oCACfC,KAAM,MACNC,SAAU,OACVC,KAAM,CACLsB,QAAQ,EACRC,MAAOJ,GAERjB,WAAY,WACXX,EAASY,KAAKhB,IAEfiB,QAAS,SAAUJ,GAClBT,EAASY,KAAK,IACdZ,EAASY,KAAKH,IAEfK,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,OAwBS,GAAdW,EAAIE,QACX7B,EAAS,EAAG,MAKd,IAAIgC,EAAa,CAChBC,IAAK,SAAUC,GACdA,EAAMC,iBACN9C,EAAE,aAAa+C,MAAM,WAEtBC,WAAY,SAAUH,GACrBA,EAAMC,iBA5MS,WACjB7C,EAAW,IAAIgD,SACf,IAAIC,EAAalD,EAAE,eACfmD,EAAIjD,EAAQkD,iBAChBpD,EAAEqD,KAAKF,EAAG,SAAUG,EAAGC,GACtBtD,EAASuD,OAAOD,EAAME,KAAMF,EAAMnB,SAGnCpC,EAAEc,KAAK,CACNC,IAAKb,EAAQwD,KAAK,UAClBzC,KAAMf,EAAQwD,KAAK,UACnBxC,SAAU,OACVC,KAAMlB,EACN0D,aAAa,EACbC,aAAa,EACbvC,WAAY,WACXnB,EAAQ2D,OACRX,EAAW5B,KAAKhB,IAEjBiB,QAAS,SAAUuC,GAIlB,GAHAZ,EAAW5B,KAAK,IAChBpB,EAAQ6D,OAEJD,EAASE,KAMZ,OALAhE,EAAE,aAAa+C,MAAM,QACrB3C,EAAM6D,KAAKH,EAASI,QAAS,WAC7BvD,EAAS,EAAGJ,GACZN,EAAW,KACXC,EAAQiE,QAAQ,UACT,EAGP/D,EAAM6D,KAAKH,EAASI,QAAS,WAG/B1C,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,MAyKZyC,IAEDC,YAAa,SAAUxB,GACtBA,EAAMC,iBACN9C,EAAE,aAAa+C,MAAM,UACrB/C,EAAE,UAAUuC,IAAIvC,EAAEmC,MAAMhB,KAAK,QAE9BmD,eAAgB,SAAUzB,GAzFV,IAAU0B,EAAIC,EA0F7B3B,EAAMC,iBA1FmByB,EA2FbvE,EAAE,UAAUuC,MA3FKiC,EA2FExE,EAAEmC,MAAMhB,KAAK,QA1F9CnB,EAAEc,KAAK,CACNC,IAAKC,QAAU,kCACfC,KAAM,OACNC,SAAU,OACVC,KAAM,CACLsD,IAAKF,EACLG,eAAgBF,GAEjBjD,QAAS,SAAUuC,GACdA,EAASE,MACZhE,EAAE,aAAa+C,MAAM,QACrB3C,EAAM6D,KAAKH,EAASI,QAAS,WAC7BvD,EAAS,EAAGJ,IAGZH,EAAM6D,KAAKH,EAASI,QAAS,UAG9BK,EAAK,MAEN/C,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,OAuEbgD,aAAc,SAAU9B,GACvBA,EAAMC,iBAzIY,WACpB7C,EAAW,IAAIgD,SACf,IAAI2B,EAAU5E,EAAE,YAEZmD,EAAIhD,EAASiD,iBACjBpD,EAAEqD,KAAKF,EAAG,SAAUG,EAAGC,GACtBtD,EAASuD,OAAOD,EAAME,KAAMF,EAAMnB,SAGnCpC,EAAEc,KAAK,CACNC,IAAKZ,EAASuD,KAAK,UACnBzC,KAAMd,EAASuD,KAAK,UACpBxC,SAAU,OACVC,KAAMlB,EACN0D,aAAa,EACbC,aAAa,EACbvC,WAAY,WACXuD,EAAQtD,KAAKhB,GACbH,EAAS0D,QAEVtC,QAAS,SAAUuC,GAIlB,GAHAc,EAAQtD,KAAK,IACbnB,EAAS4D,OAELD,EAASE,KAMZ,OALAhE,EAAE,cAAc+C,MAAM,QACtB3C,EAAM6D,KAAKH,EAASI,QAAS,WAC7BvD,EAAS,EAAGJ,GACZN,EAAW,KACXE,EAASgE,QAAQ,UACV,EAGP/D,EAAM6D,KAAKH,EAASI,QAAS,WAG/B1C,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,MAqGZkD,CAAe7E,EAAEmC,MAAMhB,KAAK,QAE7B2D,UAAW,SAAUjC,GAjLJ,IAAU0B,EAAIC,EAC5BI,EAiLF/B,EAAMC,iBACN9C,EAAE,cAAc+C,MAAM,UAnLIwB,EAoLbvE,EAAEmC,MAAMhB,KAAK,MApLIqD,EAoLGxE,EAAEmC,MAAMhB,KAAK,QAnL5CyD,EAAU5E,EAAE,YAChBA,EAAEc,KAAK,CACNC,IAAKC,QAAU,yCACfC,KAAM,OACNC,SAAU,OACVC,KAAM,CACLsD,IAAKF,EACLG,eAAgBF,GAEjBnD,WAAY,WACXuD,EAAQtD,KAAKhB,GACbH,EAAS0D,QAEVtC,QAAS,SAAUJ,GAGlB,GAFAyD,EAAQtD,KAAK,IACbnB,EAAS4D,OACL/D,EAAE+E,cAAc5D,IAAiB,MAARA,EAI5B,OAHAnB,EAAE,cAAc+C,MAAM,QACtB3C,EAAM6D,KAAK,uBAAwB,UACnCrC,QAAQC,IAAI,UACL,EAEP7B,EAAE,WAAWuC,IAAIpB,EAAK6D,WACtBhF,EAAE,WAAWuC,IAAIpB,EAAK8D,UACtBjF,EAAE,YAAYuC,IAAIpB,EAAK+D,QACvBlF,EAAE,WAAWuC,IAAIpB,EAAKgE,OACtBnF,EAAE,mBAAmBuC,IAAIpB,EAAKiE,SAIhC5D,KAAM,SAAUC,EAAOC,EAAYC,GAClCC,QAAQC,IAAIF,OAsJb0D,eAAgB,SAAUxC,GACzBA,EAAMC,iBACN9C,EAAE,aAAasF,KAAK,gBAAiB,GACrC3E,EAAS,EAAGJ,IAEbgF,WAAY,SAAU1C,GACrBA,EAAMC,iBACN,IAAI1B,EAAOpB,EAAEmC,MAAMhB,KAAK,sBACxBR,EAASS,EAAMb,KAIjBP,EAAEwF,UAAUtD,GAAG,QAAS,iBAAkB,SAAUW,GACnD,IACI4C,EADOzF,EAAEmC,MACKhB,KAAK,UAEW,mBAAvBwB,EAAW8C,IACrB9C,EAAW8C,GAAQC,KAAKvD,KAAMU","file":"../customer.js","sourcesContent":["$(function () {\r\n\r\n\t/* Varibales */\r\n\r\n\tvar formData = null;\r\n\tvar formAdd = $('#formAddCustomer');\r\n\tvar formEdit = $('#formEditCustomer');\r\n\tvar hulla = new hullabaloo();\r\n\tvar spinner = '<i class=\"fa fa-spinner fa-spin fa-lg fa-fw d-block mx-auto text-primary mt-3\"></i><span class=\"sr-only\">Loading...</span>';\r\n\tvar rows = $('#rowCount').find(\":selected\").text();\r\n\tvar htmlData = $('#allCustomerData');\r\n\t\r\n\t/* Functions */\r\n\r\n\t// Executing functions according to url\r\n\tvar urlBasedAction = function () {\r\n\t\treturn window.location.pathname.split('/');\r\n\t};\r\n\r\n\t// Populating the customers grid \r\n\tvar populate = function (pg, rw) {\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/populate',\r\n\t\t\ttype: 'GET',\r\n\t\t\tdataType: 'html',\r\n\t\t\tdata: {\r\n\t\t\t\tpage: pg,\r\n\t\t\t\trows: rw\r\n\t\t\t},\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\thtmlData.html(spinner);\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\thtmlData.html('');\r\n\t\t\t\thtmlData.html(data);\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// Add a new customer\r\n\tvar addCustomer = function () {\r\n\t\tformData = new FormData();\r\n\t\tvar ajaxLoader = $('#ajaxLoader');\r\n\t\tvar x = formAdd.serializeArray();\r\n\t\t$.each(x, function (i, field) {\r\n\t\t\tformData.append(field.name, field.value);\r\n\t\t});\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: formAdd.attr(\"action\"),\r\n\t\t\ttype: formAdd.attr(\"method\"),\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: formData,\r\n\t\t\tprocessData: false,\r\n\t\t\tcontentType: false,\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\tformAdd.hide();\r\n\t\t\t\tajaxLoader.html(spinner);\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\tajaxLoader.html('');\r\n\t\t\t\tformAdd.show();\r\n\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#addModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\t\t\t\t\tformData = null;\r\n\t\t\t\t\tformAdd.trigger(\"reset\");\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n\r\n\t// Populate Edit form\r\n\tvar populateEdit = function (id, token) {\r\n\t\tvar eLoader = $('#eLoader');\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/populate-edit',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: {\r\n\t\t\t\tcid: id,\r\n\t\t\t\tcsrf_test_name: token\r\n\t\t\t},\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\teLoader.html(spinner);\r\n\t\t\t\tformEdit.hide();\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\teLoader.html('');\r\n\t\t\t\tformEdit.show();\r\n\t\t\t\tif ($.isEmptyObject(data) || data == null) {\r\n\t\t\t\t\t$('#editModal').modal('hide');\r\n\t\t\t\t\thulla.send('Unable to fetch data', 'danger');\r\n\t\t\t\t\tconsole.log('empty');\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#eFname').val(data.firstname);\r\n\t\t\t\t\t$('#eLname').val(data.lastname);\r\n\t\t\t\t\t$('#eNumber').val(data.number);\r\n\t\t\t\t\t$('#eEmail').val(data.email);\r\n\t\t\t\t\t$('#customerEditId').val(data.custid);\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\t// Update Customer based on user input\r\n\tvar updateCustomer = function () {\r\n\t\tformData = new FormData();\r\n\t\tvar eLoader = $('#eLoader');\r\n\r\n\t\tvar x = formEdit.serializeArray();\r\n\t\t$.each(x, function (i, field) {\r\n\t\t\tformData.append(field.name, field.value);\r\n\t\t});\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: formEdit.attr(\"action\"),\r\n\t\t\ttype: formEdit.attr(\"method\"),\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: formData,\r\n\t\t\tprocessData: false,\r\n\t\t\tcontentType: false,\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\teLoader.html(spinner);\r\n\t\t\t\tformEdit.hide();\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\teLoader.html('');\r\n\t\t\t\tformEdit.show();\r\n\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#editModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\t\t\t\t\tformData = null;\r\n\t\t\t\t\tformEdit.trigger(\"reset\");\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// Delete customer\r\n\tvar delCustomer = function (id, token) {\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/delete',\r\n\t\t\ttype: 'POST',\r\n\t\t\tdataType: 'JSON',\r\n\t\t\tdata: {\r\n\t\t\t\tcid: id,\r\n\t\t\t\tcsrf_test_name: token\r\n\t\t\t},\r\n\t\t\tsuccess: function (response) {\r\n\t\t\t\tif (response.auth) {\r\n\t\t\t\t\t$('#delModal').modal('hide');\r\n\t\t\t\t\thulla.send(response.message, 'success');\r\n\t\t\t\t\tpopulate(1, rows);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\thulla.send(response.message, 'danger');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tid = null;\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t// Search customer\r\n\tvar searchCustomer = function (key) {\r\n\t\t$.ajax({\r\n\t\t\turl: baseurl + 'admin/customers/customer/populate',\r\n\t\t\ttype: 'GET',\r\n\t\t\tdataType: 'html',\r\n\t\t\tdata: {\r\n\t\t\t\tsearch: true,\r\n\t\t\t\tquery: key\r\n\t\t\t},\r\n\t\t\tbeforeSend: function () {\r\n\t\t\t\thtmlData.html(spinner);\r\n\t\t\t},\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\thtmlData.html('');\r\n\t\t\t\thtmlData.html(data);\r\n\t\t\t},\r\n\t\t\tfail: function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tconsole.log(errorThrown);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t/* Binding */\r\n\r\n\t// Uri Action\r\n\tvar uri = urlBasedAction();\r\n\r\n\t// Trigerring the populate customer function\r\n\tif (uri[2] == 'customer') {\r\n\t\tpopulate(1, rows);\r\n\r\n\t\t$('#rowCount').on('change', function () {\r\n\t\t\tpopulate(1, this.value);\r\n\t\t});\r\n\r\n\t\t// Search\r\n\t\t$(\"#searchCst\").keyup(function () {\r\n\t\t\tvar key = $(this).val();\r\n\t\t\tif (key.length >= 1) {\r\n\t\t\t\tsearchCustomer(key);\r\n\t\t\t}\r\n\t\t\telse if(key.length == 0 ) {\r\n\t\t\t\tpopulate(1, 10);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Anchor button actions binding\r\n\t\tvar btnActions = {\r\n\t\t\tadd: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#addModal').modal('toggle');\r\n\t\t\t},\r\n\t\t\tadCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\taddCustomer();\r\n\t\t\t},\r\n\t\t\tdeleteModal: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#delModal').modal('toggle');\r\n\t\t\t\t$('#cstid').val($(this).data('id'));\r\n\t\t\t},\r\n\t\t\tdeleteCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tdelCustomer($('#cstid').val(), $(this).data('csrf'));\r\n\t\t\t},\r\n\t\t\teditCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tupdateCustomer($(this).data('id'));\r\n\t\t\t},\r\n\t\t\teditModal: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#editModal').modal('toggle');\r\n\t\t\t\tpopulateEdit($(this).data('id'), $(this).data('csrf'));\r\n\t\t\t},\r\n\t\t\treloadCustomer: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\t$('#rowCount').prop('selectedIndex', 0);\r\n\t\t\t\tpopulate(1, rows);\r\n\t\t\t},\r\n\t\t\tpagination: function (event) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tvar page = $(this).data(\"ci-pagination-page\");\r\n\t\t\t\tpopulate(page, rows);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$(document).on(\"click\", 'a[data-action]', function (event) {\r\n\t\t\tvar link = $(this);\r\n\t\t\tvar action = link.data(\"action\");\r\n\r\n\t\t\tif (typeof btnActions[action] === \"function\") {\r\n\t\t\t\tbtnActions[action].call(this, event);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}); // End of document ready"]}