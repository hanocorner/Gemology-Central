{"version":3,"sources":["report.js"],"names":["$","reptype","messageBox","message","msg","type","baseurl","getId","reportType","ajax","url","dataType","data","repotype","success","val","fail","console","log","on","event","fm","form","formData","cstid","gemid","commentData","preventDefault","this","FormData","CKEDITOR","instances","editor1","getData","append","attr","processData","contentType","beforeSend","modal","backdrop","keyboard","html","response","csrf","auth","css","trigger","error","jqXHR","textStatus","errorThrown","click","id","focusout","num","value","res","Number","split","length","toFixed","autocomplete","source","request","q","term","results","map","key","label","gem_name","minLength","select","ui","item","cus_firstname","cus_lastname","custid","spgroup","shapecut","color","checkboxradio","icon","change","input","file","files","Array","RegExp","test","toLowerCase","alert","size","reader","FileReader","onload","e","image","Image","src","target","result","height","width","readAsDataURL","imageReader","location","reload","gemName","gemDesc","csrf_test_name","setTimeout","errorResponse"],"mappings":"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","file":"../report.js","sourcesContent":["$(function() {\r\n\r\n  /* Varibales */\r\n  var reptype = $('#radio-1, #radio-2, #radio-3');\r\n  var amount = $(\"#amount\");\r\n  var form, formData = null;\r\n  var messageBox = null;\r\n\r\n  /* Functions */\r\n\r\n  //\r\n  var message = function (msg, type) {\r\n\t\tvar box;\r\n\t\tswitch (type) {\r\n\t\t\tcase 'error':\r\n\t\t\t\treturn '<div class=\"notify-box\">' +\r\n\t\t\t\t\t'<noscript>Sorry, your browser does not support JavaScript!</noscript>' +\r\n\t\t\t\t\t'<div class=\"error d-flex align-items-center\">' +\r\n\t\t\t\t\t'<img src=\"' + baseurl + 'assets/images/error.png\" alt=\"Error-Image\" class=\"img-fluid\">' +\r\n\t\t\t\t\t'<div>' + msg + '<div>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>';\r\n\t\t\tcase 'success':\r\n\t\t\t\treturn '<div class=\"notify-box\">' +\r\n\t\t\t\t\t'<noscript>Sorry, your browser does not support JavaScript!</noscript>' +\r\n\t\t\t\t\t'<div class=\"success d-flex align-items-center\">' +\r\n\t\t\t\t\t'<img src=\"' + baseurl + 'assets/images/success.png\" alt=\"Success-Image\" class=\"img-fluid\">' +\r\n\t\t\t\t\t'<p>' + msg + '</p>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>';\r\n\t\t\tcase 'info':\r\n\t\t\t\treturn '<div class=\"notify-box\">' +\r\n\t\t\t\t\t'<noscript>Sorry, your browser does not support JavaScript!</noscript>' +\r\n\t\t\t\t\t'<div class=\"info d-flex align-items-center\">' +\r\n\t\t\t\t\t'<img src=\"' + baseurl + 'assets/images/info.png\" alt=\"Success-Image\" class=\"img-fluid\">' +\r\n\t\t\t\t\t'<p>' + msg + '</p>' +\r\n\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t'</div>';\r\n\t\t\tdefault:\r\n\t\t\t\treturn 'Unable to display Message';\r\n\t\t}\r\n  }\r\n  \r\n  // Fetch ID Based on user select\r\n  var getId = function(reportType) {\r\n    $.ajax({\r\n      url: baseurl + 'admin/report/handler/id',\r\n      type: 'GET',\r\n      dataType: 'html',\r\n      data: {\r\n        repotype: reportType\r\n      },\r\n      success: function(data) {\r\n        $('#id').val(data);\r\n      },\r\n      fail: function() {\r\n        console.log('Error');\r\n      }\r\n    });\r\n  }\r\n\r\n  // Function to populate customer on user input\r\n  var populateCustomer = function() {\r\n    $(\"#customer\").autocomplete({\r\n      source: function(request, response) {\r\n        $.ajax({\r\n          url: baseurl + 'admin/customers/customer/append-customer',\r\n          dataType: \"json\",\r\n          data: {\r\n            q: request.term\r\n          }\r\n        }).success(function(data) {\r\n          var results = $.map(data, function(value, key) {\r\n            return {\r\n              label: value.cus_firstname + ' ' + value.cus_lastname,\r\n              value: value.cus_firstname + ' ' + value.cus_lastname,\r\n              id: value.custid\r\n            };\r\n          });\r\n          response(results);\r\n        });\r\n      },\r\n      minLength: 1,\r\n      select: function(event, ui) {\r\n        $('#customerID').val(ui.item.id);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Function to populate gemstone field on user input\r\n  var populateGemstone = function() {\r\n    $(\"#newGem\").autocomplete({\r\n      source: function(request, response) {\r\n        $.ajax({\r\n          url: baseurl + 'admin/report/gemstone/gem-list',\r\n          dataType: \"json\",\r\n          data: {\r\n            q: request.term\r\n          }\r\n        }).success(function(data) {\r\n          var results = $.map(data, function(value, key) {\r\n            return {\r\n              label: value.gem_name,\r\n              value: value.gem_name,\r\n              id: value.gemid\r\n            };\r\n          });\r\n          response(results);\r\n        });\r\n      },\r\n      minLength: 1,\r\n      select: function(event, ui) {\r\n        $('#gemid').val(ui.item.id);\r\n        $('input[name=variety]').val(ui.item.value);\r\n      }\r\n    });\r\n  };\r\n\r\n  // Function to add decimal value(.00) to the amount field\r\n  // (if there is no decimal value from user input)\r\n  var addZero = function(num) {\r\n    var value = Number(num);\r\n    var res = num.split(\".\");\r\n    if (res.length == 1 || (res[1].length < 3)) {\r\n      value = value.toFixed(2);\r\n    }\r\n    return value\r\n  };\r\n\r\n  // Function to populate species/group field on user input\r\n  var populateSpeciesGroup = function() {\r\n    $(\"#sgField\").autocomplete({\r\n      source: function(request, response) {\r\n        $.ajax({\r\n          url: baseurl + 'admin/report/handler/populate-spgroup',\r\n          dataType: \"json\",\r\n          data: {\r\n            q: request.term\r\n          }\r\n        }).success(function(data) {\r\n          var results = $.map(data, function(value, key) {\r\n            return {\r\n              label: value.spgroup,\r\n              value: value.spgroup\r\n            };\r\n          });\r\n          response(results);\r\n        });\r\n      },\r\n      minLength: 2\r\n    });\r\n  };\r\n\r\n  // Function to populate shape-cut field on user input\r\n  var populateShapeCut = function() {\r\n    $(\"#shapecutField\").autocomplete({\r\n      source: function(request, response) {\r\n        $.ajax({\r\n          url: baseurl + 'admin/report/handler/populate-shapecut',\r\n          dataType: \"json\",\r\n          data: {\r\n            q: request.term\r\n          }\r\n        }).success(function(data) {\r\n          var results = $.map(data, function(value, key) {\r\n            return {\r\n              label: value.shapecut,\r\n              value: value.shapecut\r\n            };\r\n          });\r\n          response(results);\r\n        });\r\n      },\r\n      minLength: 2\r\n    });\r\n  };\r\n\r\n  // Function to populate color field on user input\r\n  var populateColor = function() {\r\n    $(\"#colorField\").autocomplete({\r\n      source: function(request, response) {\r\n        $.ajax({\r\n          url: baseurl + 'admin/report/handler/populate-color',\r\n          dataType: \"json\",\r\n          data: {\r\n            q: request.term\r\n          }\r\n        }).success(function(data) {\r\n          var results = $.map(data, function(value, key) {\r\n            return {\r\n              label: value.color,\r\n              value: value.color\r\n            };\r\n          });\r\n          response(results);\r\n        });\r\n      },\r\n      minLength: 2\r\n    });\r\n  };\r\n\r\n  var imageReader = function(input) {\r\n    var file = input.files[0];\r\n    // Message array\r\n    var message = new Array();\r\n    message['allowedTypes'] = \"Not a valid image format, Please upload following file type jpg|jpeg|png|gif \";\r\n    message['height'] = \"Height is too large, Please upload an image less than 1024px\";\r\n    message['width'] = \"Width is too large, Please upload an image less than 1024px\";\r\n    message['fileSize'] = \"File size is too large, Please upload an image less than 2MB\";\r\n\r\n    // Regular Expression to validate image allowed types\r\n    var regex = new RegExp(\"([a-zA-Z0-9\\s_\\\\.\\-:])+(.jpg|.jpeg|.png|.gif)$\");\r\n    if (!regex.test(input.value.toLowerCase())) {\r\n      alert(message['allowedTypes']);\r\n      return false;\r\n    }\r\n    // File size MAX 2MB\r\n    if (file.size > 2000000) {\r\n      alert(message['fileSize']);\r\n      return false;\r\n    }\r\n    if (input.files && input.files[0]) {\r\n      var reader = new FileReader();\r\n\r\n      reader.onload = function(e) {\r\n        //Initiate the JavaScript Image object.\r\n        var image = new Image();\r\n\r\n        //Set the Base64 string return from FileReader as source.\r\n        image.src = e.target.result;\r\n\r\n        //Validate the File Height and Width.\r\n        image.onload = function() {\r\n          var height = this.height;\r\n          var width = this.width;\r\n          if (width > 1024) {\r\n            alert(message['width']);\r\n            return false;\r\n          }\r\n          else if (height > 1024) {\r\n            alert(message['height']);\r\n            return false;\r\n          }\r\n          $('#imagegem').attr('src', e.target.result);\r\n          return true;\r\n        };\r\n      }\r\n      reader.readAsDataURL(input.files[0]);\r\n    }\r\n    $('#removeImg').on('click', function() {\r\n      $('#imagegem').attr('src', baseurl+'assets/images/default-img.png');\r\n      $(\"#imginput\").val('');\r\n    });\r\n  };\r\n\r\n  // Function to Add a Report to DB\r\n  var addReport = function(fm) {\r\n\r\n    var form = $('#formReport');\r\n    var formData = new FormData(fm);\r\n    var cstid = $('#customerID').val();\r\n    var gemid = $('#gemid').val();\r\n    var commentData = CKEDITOR.instances.editor1.getData();\r\n\r\n    formData.append(\"customer\", cstid);\r\n    formData.append(\"gemid\", gemid);\r\n    formData.append(\"editor1\", commentData);\r\n\r\n    $.ajax({\r\n      url: form.attr(\"action\"),\r\n      type: form.attr(\"method\"),\r\n      dataType: 'JSON',\r\n      data: formData,\r\n      processData: false,\r\n      contentType: false,\r\n      beforeSend: function() {\r\n        $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n        $('#messageModal .modal-body').html(message('Processing', 'info'));\r\n      },\r\n      success: function(response) {\r\n        $('input[name=csrf_test_name]', '#formReport').val(response.csrf);\r\n\r\n        if (response.auth) {\r\n          \r\n          $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n          $('#messageModal .modal-body').html(\r\n            message(response.message, 'success')+\r\n            '<div class=\"d-flex align-items-center mt-3\">'+\r\n            '<img src=\"'+baseurl+'assets/images/qr/temp.png\" alt=\"QR-Code\" width=\"200\" height=\"200\"> '+\r\n            '<a href=\"'+response.url+'\" class=\"btn btn-danger ml-4\"><i class=\"fa fa-download fa-fw\" aria-hidden=\"true\"></i> Download QR</a>'+\r\n            '</div>'\r\n          );\r\n\r\n          $('#messageModal .modal-footer').html(\r\n            '<a href=\"'+baseurl+'admin/report/all\" class=\"mr-3\">Go to all reports</a>'+\r\n            '<a href=\"#\" id=\"anotherReport\" class=\"btn btn-primary\">Create Another</a>'\r\n          );\r\n\r\n          $('#messageModal .close').css('display', 'none');\r\n          formData = null;\r\n          $('#imagegem').attr('src', baseurl+'assets/images/default-img.png');\r\n          form.trigger('reset');\r\n          return true;\r\n\r\n        } else {\r\n          $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n          $('#messageModal .modal-body').html(message(response.message, 'error'));\r\n          $('#message').html(message(response.message, 'error'));\r\n        }\r\n\r\n      },\r\n      error: function (jqXHR, textStatus, errorThrown) {\r\n        $('#messageModal').modal('show');\r\n        $('#messageModal .modal-body').html(message(errorThrown, 'error'));\r\n      }\r\n    });\r\n\r\n  };\r\n\r\n  var updateReport = function () {\r\n\r\n    var form = $('#updateReportForm');\r\n    var formData = new FormData($('#updateReportForm'));\r\n\r\n    var gemid = $('#gemid').val();\r\n    var commentData = CKEDITOR.instances.editor1.getData();\r\n\r\n    formData.append(\"gemid\", gemid);\r\n    formData.append(\"editor1\", commentData);\r\n    formData.append(\"csrf_test_name\", $('input[name=csrf_test_name]').val());\r\n\r\n    $.ajax({\r\n      url: form.attr(\"action\"),\r\n      type: form.attr(\"method\"),\r\n      dataType: 'JSON',\r\n      data: formData,\r\n      processData: false,\r\n      contentType: false,\r\n      beforeSend: function() {\r\n        $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n        $('#messageModal .modal-body').html(message('Processing...', 'info'));\r\n      },\r\n      success: function(response) {\r\n        console.log('hello');\r\n        \r\n        $('input[name=csrf_test_name]', '#updateReportForm').val(response.csrf);\r\n\r\n        if (response.auth) {\r\n          $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n          $('#messageModal .close').css('display', 'none');\r\n          $('#messageModal .modal-body').html(message(response.message, 'success'));\r\n          //location.href = response.url;\r\n\r\n          formData = null;\r\n          form.trigger('reset');\r\n          return true;\r\n\r\n        } else {\r\n          $('#messageModal').modal({backdrop: 'static', keyboard: false });\r\n          $('#messageModal .modal-body').html(message(response.message, 'error'));\r\n          $('#message').html(message(response.message, 'error'));\r\n        }\r\n\r\n      },\r\n      error: function (jqXHR, textStatus, errorThrown) {\r\n        $('#messageModal').modal('show');\r\n        $('#messageModal .modal-body').html(message(errorThrown, 'error'));\r\n      }\r\n    });\r\n  };\r\n\r\n  // Function to add new gemstone\r\n  var addGemstone = function (fm) {\r\n    messageBox = $('#gemModal #message');\r\n    $.ajax({\r\n      url: fm.attr('action'),\r\n      type: fm.attr('method'),\r\n      dataType: 'JSON',\r\n      data: {\r\n        gemName:$('#gemName').val(),\r\n        gemDesc:$('#gemDesc').val(),\r\n        csrf_test_name:$('#formGemstone  input[name=csrf_test_name]').val()\r\n      },\r\n      beforeSend: function() {\r\n        messageBox.html(message('Processing...', 'info'));\r\n      },\r\n      success: function(response) {\r\n        $('#formGemstone  input[name=csrf_test_name]').val(response.csrf);\r\n\r\n        if (response.auth) {\r\n          messageBox.html(message(response.message, 'success'));\r\n          formData = null;\r\n          fm.trigger('reset');\r\n          setTimeout(function () {\r\n            messageBox.html('');\r\n          }, 5000);\r\n\r\n          return true;\r\n        }\r\n        else {\r\n          messageBox.html(message(response.message, 'error'));\r\n        }\r\n      },\r\n      fail: function(errorResponse) {\r\n        messageBox.html(message(errorResponse, 'error'));\r\n      }\r\n    });\r\n  };\r\n\r\n\r\n\r\n  /* Binding */\r\n\r\n  // Create\r\n\r\n  // Report Form submit event\r\n   $('form').on(\"submit\", function(event) {\r\n      event.preventDefault();\r\n      addReport(this);\r\n  });\r\n  \r\n  // $('form').on(\"submit\", function(event) {\r\n  //   event.preventDefault();\r\n  //   updateReport();\r\n  // });\r\n\r\n  // Update Form\r\n  // $('#updateReportForm').on('click', '#updateReport', function() {\r\n    \r\n  // });\r\n  \r\n  \r\n\r\n  reptype.click(function() {\r\n    if (this.id == 'radio-1') {\r\n      $('#repotype').val($(this).data('value'));\r\n      getId($(this).data('value'));\r\n    } else if (this.id == 'radio-2') {\r\n      $('#repotype').val($(this).data('value'));\r\n      getId($(this).data('value'));\r\n    } else if (this.id == 'radio-3') {\r\n      $('#repotype').val($(this).data('value'));\r\n      getId($(this).data('value'));\r\n    }\r\n  });\r\n\r\n  $('input[name=amount]').focusout(function() {\r\n    $('input[name=amount]').val(addZero($('input[name=amount]').val()));\r\n  });\r\n\r\n  populateGemstone();\r\n\r\n  populateCustomer();\r\n\r\n  populateSpeciesGroup();\r\n\r\n  populateShapeCut();\r\n\r\n  populateColor();\r\n\r\n  $(\"input[name=radio-1]\").checkboxradio({\r\n    icon: false\r\n  });\r\n\r\n  $(\"#imginput\").change(function(){\r\n    imageReader(this);\r\n  });\r\n\r\n  $('#messageModal').on('click', '#anotherReport', function(event) {\r\n    event.preventDefault();\r\n    location.reload();\r\n  });\r\n\r\n  $('#gemModal').on('click', '#saveGem', function() {\r\n    addGemstone($('#formGemstone'));\r\n  });\r\n\r\n}); // End of document ready\r\n"]}